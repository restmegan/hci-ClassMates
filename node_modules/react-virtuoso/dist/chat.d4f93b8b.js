// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"chat.tsx":[function(require,module,exports) {
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = App;

var _react = _interopRequireWildcard(require("react"));

var _styled = _interopRequireDefault(require("@emotion/styled"));

var _src = require("../src/");

var _faker = _interopRequireDefault(require("faker"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _templateObject4() {
  var data = _taggedTemplateLiteral(["\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n  height: 100%;\n  margin-top: 12px;\n"]);

  _templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function _templateObject3() {
  var data = _taggedTemplateLiteral(["\n  padding: 12px 24px;\n"]);

  _templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function _templateObject2() {
  var data = _taggedTemplateLiteral(["\n  background: ", ";\n  color: white;\n  width: 60%;\n  padding: 12px;\n  border-radius: 4px;\n  word-break: break-word;\n"]);

  _templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function _templateObject() {
  var data = _taggedTemplateLiteral(["\n  display: flex;\n  justify-content: ", ";\n  width: 100%;\n  padding: 12px 0;\n"]);

  _templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

var BubbleWrap = _styled.default.div(_templateObject(), function (_ref) {
  var fromUser = _ref.fromUser;
  return fromUser && 'flex-end';
});

var Content = _styled.default.div(_templateObject2(), function (_ref2) {
  var fromUser = _ref2.fromUser;
  return fromUser ? 'orange' : 'red';
});

function Bubble(_ref3) {
  var text = _ref3.text,
      fromUser = _ref3.fromUser,
      className = _ref3.className;
  return _react.default.createElement(BubbleWrap, {
    fromUser: fromUser,
    className: className
  }, _react.default.createElement(Content, {
    fromUser: fromUser
  }, text));
}

var Root = _styled.default.div(_templateObject3());

var TextWrapper = _styled.default.div(_templateObject4());

function ChatList(_ref4) {
  var userId = _ref4.userId,
      _ref4$messages = _ref4.messages,
      messages = _ref4$messages === void 0 ? [] : _ref4$messages,
      onSend = _ref4.onSend,
      onReceive = _ref4.onReceive,
      placeholder = _ref4.placeholder;

  var _useState = (0, _react.useState)(''),
      _useState2 = _slicedToArray(_useState, 2),
      newMessage = _useState2[0],
      setNewMessage = _useState2[1];

  var ref = (0, _react.useRef)(null);
  var isMyOwnMessage = (0, _react.useRef)(false);

  var onSendMessage = function onSendMessage() {
    isMyOwnMessage.current = true;
    onSend(newMessage);
    setNewMessage('');
  };

  var onReceiveMessage = function onReceiveMessage() {
    isMyOwnMessage.current = false;
    onReceive();
  };

  var row = _react.default.useMemo(function () {
    return function (i, _ref5) {
      var message = _ref5.message,
          id = _ref5.id;
      var fromUser = id === userId;
      return _react.default.createElement(Bubble, {
        key: i,
        fromUser: fromUser,
        text: message
      });
    };
  }, [userId]);

  return _react.default.createElement(Root, {
    style: {
      flex: 1,
      display: 'flex',
      flexDirection: 'column',
      border: '1px solid red'
    }
  }, _react.default.createElement(_src.Virtuoso, {
    ref: ref,
    style: {
      flex: 1
    },
    initialTopMostItemIndex: messages.length - 1,
    followOutput: function followOutput(isAtBottom) {
      if (isMyOwnMessage.current) {
        // if the user has scrolled away and sends a message, bring him to the bottom instantly
        return isAtBottom ? 'smooth' : 'auto';
      } else {
        // a message from another user has been received - don't pull to bottom unless already there
        return isAtBottom ? 'smooth' : false;
      }
    },
    itemContent: row,
    data: messages
  }), _react.default.createElement(TextWrapper, {
    style: {
      flex: 0,
      minHeight: 30
    }
  }, _react.default.createElement("form", {
    onSubmit: function onSubmit(e) {
      e.preventDefault();
      onSendMessage();
    }
  }, _react.default.createElement("input", {
    type: "text",
    value: newMessage,
    onChange: function onChange(e) {
      return setNewMessage(e.target.value);
    },
    placeholder: placeholder
  }), _react.default.createElement("button", {
    type: "submit"
  }, "send"), " |", _react.default.createElement("button", {
    type: "button",
    onClick: onReceiveMessage
  }, "receive"))));
}

var data = Array.from({
  length: 130
}, function (_) {
  return {
    id: _faker.default.random.number({
      min: 1,
      max: 2
    }).toString(),
    message: _faker.default.lorem.sentences()
  };
});

function App() {
  var _React$useState = _react.default.useState(data),
      _React$useState2 = _slicedToArray(_React$useState, 2),
      messages = _React$useState2[0],
      setMessages = _React$useState2[1];

  var userId = '1';
  return _react.default.createElement("div", {
    style: {
      height: '500px',
      display: 'flex',
      flexDirection: 'column'
    }
  }, _react.default.createElement(ChatList, {
    messages: messages,
    userId: "1",
    placeholder: "Say hi!",
    onSend: function onSend(message) {
      return setMessages(function (x) {
        return [].concat(_toConsumableArray(x), [{
          id: userId,
          message: message
        }]);
      });
    },
    onReceive: function onReceive() {
      setMessages(function (x) {
        return [].concat(_toConsumableArray(x), [{
          id: '2',
          message: _faker.default.lorem.sentences()
        }]);
      });
    }
  }));
}
},{"react":"../node_modules/react/index.js","@emotion/styled":"../node_modules/@emotion/styled/dist/styled.browser.esm.js","../src/":"../src/index.tsx","faker":"../node_modules/faker/index.js"}]},{},[], null)