{"ast":null,"code":"/*\n * JavaScript Load Image Orientation\n * https://github.com/blueimp/JavaScript-Load-Image\n *\n * Copyright 2013, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n */\n\n/*\nExif orientation values to correctly display the letter F:\n\n    1             2\n  ██████        ██████\n  ██                ██\n  ████            ████\n  ██                ██\n  ██                ██\n\n    3             4\n      ██        ██\n      ██        ██\n    ████        ████\n      ██        ██\n  ██████        ██████\n\n    5             6\n██████████    ██\n██  ██        ██  ██\n██            ██████████\n\n    7             8\n        ██    ██████████\n    ██  ██        ██  ██\n██████████            ██\n\n*/\n\n/* global define, module, require */\n;\n\n(function (factory) {\n  'use strict';\n\n  if (typeof define === 'function' && define.amd) {\n    // Register as an anonymous AMD module:\n    define(['./load-image', './load-image-scale', './load-image-meta'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    factory(require('./load-image'), require('./load-image-scale'), require('./load-image-meta'));\n  } else {\n    // Browser globals:\n    factory(window.loadImage);\n  }\n})(function (loadImage) {\n  'use strict';\n\n  var originalTransform = loadImage.transform;\n  var originalRequiresCanvas = loadImage.requiresCanvas;\n  var originalRequiresMetaData = loadImage.requiresMetaData;\n  var originalTransformCoordinates = loadImage.transformCoordinates;\n  var originalGetTransformedOptions = loadImage.getTransformedOptions;\n\n  (function ($) {\n    // Guard for non-browser environments (e.g. server-side rendering):\n    if (!$.global.document) return; // black+white 3x2 JPEG, with the following meta information set:\n    // - EXIF Orientation: 6 (Rotated 90° CCW)\n    // Image data layout (B=black, F=white):\n    // BFF\n    // BBB\n\n    var testImageURL = 'data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA' + 'AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA' + 'QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE' + 'BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/x' + 'ABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAA' + 'AAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQ' + 'voP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXw' + 'H/9k=';\n    var img = document.createElement('img');\n\n    img.onload = function () {\n      // Check if the browser supports automatic image orientation:\n      $.orientation = img.width === 2 && img.height === 3;\n\n      if ($.orientation) {\n        var canvas = $.createCanvas(1, 1, true);\n        var ctx = canvas.getContext('2d');\n        ctx.drawImage(img, 1, 1, 1, 1, 0, 0, 1, 1); // Check if the source image coordinates (sX, sY, sWidth, sHeight) are\n        // correctly applied to the auto-orientated image, which should result\n        // in a white opaque pixel (e.g. in Safari).\n        // Browsers that show a transparent pixel (e.g. Chromium) fail to crop\n        // auto-oriented images correctly and require a workaround, e.g.\n        // drawing the complete source image to an intermediate canvas first.\n        // See https://bugs.chromium.org/p/chromium/issues/detail?id=1074354\n\n        $.orientationCropBug = ctx.getImageData(0, 0, 1, 1).data.toString() !== '255,255,255,255';\n      }\n    };\n\n    img.src = testImageURL;\n  })(loadImage);\n  /**\n   * Determines if the orientation requires a canvas element.\n   *\n   * @param {object} [options] Options object\n   * @param {boolean} [withMetaData] Is metadata required for orientation\n   * @returns {boolean} Returns true if orientation requires canvas/meta\n   */\n\n\n  function requiresCanvasOrientation(options, withMetaData) {\n    var orientation = options && options.orientation;\n    return (// Exif orientation for browsers without automatic image orientation:\n      orientation === true && !loadImage.orientation || // Orientation reset for browsers with automatic image orientation:\n      orientation === 1 && loadImage.orientation || // Orientation to defined value, requires meta for orientation reset only:\n      (!withMetaData || loadImage.orientation) && orientation > 1 && orientation < 9\n    );\n  }\n  /**\n   * Determines if the image requires an orientation change.\n   *\n   * @param {number} [orientation] Defined orientation value\n   * @param {number} [autoOrientation] Auto-orientation based on Exif data\n   * @returns {boolean} Returns true if an orientation change is required\n   */\n\n\n  function requiresOrientationChange(orientation, autoOrientation) {\n    return orientation !== autoOrientation && (orientation === 1 && autoOrientation > 1 && autoOrientation < 9 || orientation > 1 && orientation < 9);\n  }\n  /**\n   * Determines orientation combinations that require a rotation by 180°.\n   *\n   * The following is a list of combinations that return true:\n   *\n   * 2 (flip) => 5 (rot90,flip), 7 (rot90,flip), 6 (rot90), 8 (rot90)\n   * 4 (flip) => 5 (rot90,flip), 7 (rot90,flip), 6 (rot90), 8 (rot90)\n   *\n   * 5 (rot90,flip) => 2 (flip), 4 (flip), 6 (rot90), 8 (rot90)\n   * 7 (rot90,flip) => 2 (flip), 4 (flip), 6 (rot90), 8 (rot90)\n   *\n   * 6 (rot90) => 2 (flip), 4 (flip), 5 (rot90,flip), 7 (rot90,flip)\n   * 8 (rot90) => 2 (flip), 4 (flip), 5 (rot90,flip), 7 (rot90,flip)\n   *\n   * @param {number} [orientation] Defined orientation value\n   * @param {number} [autoOrientation] Auto-orientation based on Exif data\n   * @returns {boolean} Returns true if rotation by 180° is required\n   */\n\n\n  function requiresRot180(orientation, autoOrientation) {\n    if (autoOrientation > 1 && autoOrientation < 9) {\n      switch (orientation) {\n        case 2:\n        case 4:\n          return autoOrientation > 4;\n\n        case 5:\n        case 7:\n          return autoOrientation % 2 === 0;\n\n        case 6:\n        case 8:\n          return autoOrientation === 2 || autoOrientation === 4 || autoOrientation === 5 || autoOrientation === 7;\n      }\n    }\n\n    return false;\n  } // Determines if the target image should be a canvas element:\n\n\n  loadImage.requiresCanvas = function (options) {\n    return requiresCanvasOrientation(options) || originalRequiresCanvas.call(loadImage, options);\n  }; // Determines if metadata should be loaded automatically:\n\n\n  loadImage.requiresMetaData = function (options) {\n    return requiresCanvasOrientation(options, true) || originalRequiresMetaData.call(loadImage, options);\n  };\n\n  loadImage.transform = function (img, options, callback, file, data) {\n    originalTransform.call(loadImage, img, options, function (img, data) {\n      if (data) {\n        var autoOrientation = loadImage.orientation && data.exif && data.exif.get('Orientation');\n\n        if (autoOrientation > 4 && autoOrientation < 9) {\n          // Automatic image orientation switched image dimensions\n          var originalWidth = data.originalWidth;\n          var originalHeight = data.originalHeight;\n          data.originalWidth = originalHeight;\n          data.originalHeight = originalWidth;\n        }\n      }\n\n      callback(img, data);\n    }, file, data);\n  }; // Transforms coordinate and dimension options\n  // based on the given orientation option:\n\n\n  loadImage.getTransformedOptions = function (img, opts, data) {\n    var options = originalGetTransformedOptions.call(loadImage, img, opts);\n    var exifOrientation = data.exif && data.exif.get('Orientation');\n    var orientation = options.orientation;\n    var autoOrientation = loadImage.orientation && exifOrientation;\n    if (orientation === true) orientation = exifOrientation;\n\n    if (!requiresOrientationChange(orientation, autoOrientation)) {\n      return options;\n    }\n\n    var top = options.top;\n    var right = options.right;\n    var bottom = options.bottom;\n    var left = options.left;\n    var newOptions = {};\n\n    for (var i in options) {\n      if (Object.prototype.hasOwnProperty.call(options, i)) {\n        newOptions[i] = options[i];\n      }\n    }\n\n    newOptions.orientation = orientation;\n\n    if (orientation > 4 && !(autoOrientation > 4) || orientation < 5 && autoOrientation > 4) {\n      // Image dimensions and target dimensions are switched\n      newOptions.maxWidth = options.maxHeight;\n      newOptions.maxHeight = options.maxWidth;\n      newOptions.minWidth = options.minHeight;\n      newOptions.minHeight = options.minWidth;\n      newOptions.sourceWidth = options.sourceHeight;\n      newOptions.sourceHeight = options.sourceWidth;\n    }\n\n    if (autoOrientation > 1) {\n      // Browsers which correctly apply source image coordinates to\n      // auto-oriented images\n      switch (autoOrientation) {\n        case 2:\n          // Horizontal flip\n          right = options.left;\n          left = options.right;\n          break;\n\n        case 3:\n          // 180° Rotate CCW\n          top = options.bottom;\n          right = options.left;\n          bottom = options.top;\n          left = options.right;\n          break;\n\n        case 4:\n          // Vertical flip\n          top = options.bottom;\n          bottom = options.top;\n          break;\n\n        case 5:\n          // Horizontal flip + 90° Rotate CCW\n          top = options.left;\n          right = options.bottom;\n          bottom = options.right;\n          left = options.top;\n          break;\n\n        case 6:\n          // 90° Rotate CCW\n          top = options.left;\n          right = options.top;\n          bottom = options.right;\n          left = options.bottom;\n          break;\n\n        case 7:\n          // Vertical flip + 90° Rotate CCW\n          top = options.right;\n          right = options.top;\n          bottom = options.left;\n          left = options.bottom;\n          break;\n\n        case 8:\n          // 90° Rotate CW\n          top = options.right;\n          right = options.bottom;\n          bottom = options.left;\n          left = options.top;\n          break;\n      } // Some orientation combinations require additional rotation by 180°:\n\n\n      if (requiresRot180(orientation, autoOrientation)) {\n        var tmpTop = top;\n        var tmpRight = right;\n        top = bottom;\n        right = left;\n        bottom = tmpTop;\n        left = tmpRight;\n      }\n    }\n\n    newOptions.top = top;\n    newOptions.right = right;\n    newOptions.bottom = bottom;\n    newOptions.left = left; // Account for defined browser orientation:\n\n    switch (orientation) {\n      case 2:\n        // Horizontal flip\n        newOptions.right = left;\n        newOptions.left = right;\n        break;\n\n      case 3:\n        // 180° Rotate CCW\n        newOptions.top = bottom;\n        newOptions.right = left;\n        newOptions.bottom = top;\n        newOptions.left = right;\n        break;\n\n      case 4:\n        // Vertical flip\n        newOptions.top = bottom;\n        newOptions.bottom = top;\n        break;\n\n      case 5:\n        // Vertical flip + 90° Rotate CW\n        newOptions.top = left;\n        newOptions.right = bottom;\n        newOptions.bottom = right;\n        newOptions.left = top;\n        break;\n\n      case 6:\n        // 90° Rotate CW\n        newOptions.top = right;\n        newOptions.right = bottom;\n        newOptions.bottom = left;\n        newOptions.left = top;\n        break;\n\n      case 7:\n        // Horizontal flip + 90° Rotate CW\n        newOptions.top = right;\n        newOptions.right = top;\n        newOptions.bottom = left;\n        newOptions.left = bottom;\n        break;\n\n      case 8:\n        // 90° Rotate CCW\n        newOptions.top = left;\n        newOptions.right = top;\n        newOptions.bottom = right;\n        newOptions.left = bottom;\n        break;\n    }\n\n    return newOptions;\n  }; // Transform image orientation based on the given EXIF orientation option:\n\n\n  loadImage.transformCoordinates = function (canvas, options, data) {\n    originalTransformCoordinates.call(loadImage, canvas, options, data);\n    var orientation = options.orientation;\n    var autoOrientation = loadImage.orientation && data.exif && data.exif.get('Orientation');\n\n    if (!requiresOrientationChange(orientation, autoOrientation)) {\n      return;\n    }\n\n    var ctx = canvas.getContext('2d');\n    var width = canvas.width;\n    var height = canvas.height;\n    var sourceWidth = width;\n    var sourceHeight = height;\n\n    if (orientation > 4 && !(autoOrientation > 4) || orientation < 5 && autoOrientation > 4) {\n      // Image dimensions and target dimensions are switched\n      canvas.width = height;\n      canvas.height = width;\n    }\n\n    if (orientation > 4) {\n      // Destination and source dimensions are switched\n      sourceWidth = height;\n      sourceHeight = width;\n    } // Reset automatic browser orientation:\n\n\n    switch (autoOrientation) {\n      case 2:\n        // Horizontal flip\n        ctx.translate(sourceWidth, 0);\n        ctx.scale(-1, 1);\n        break;\n\n      case 3:\n        // 180° Rotate CCW\n        ctx.translate(sourceWidth, sourceHeight);\n        ctx.rotate(Math.PI);\n        break;\n\n      case 4:\n        // Vertical flip\n        ctx.translate(0, sourceHeight);\n        ctx.scale(1, -1);\n        break;\n\n      case 5:\n        // Horizontal flip + 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI);\n        ctx.scale(-1, 1);\n        break;\n\n      case 6:\n        // 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI);\n        ctx.translate(-sourceWidth, 0);\n        break;\n\n      case 7:\n        // Vertical flip + 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI);\n        ctx.translate(-sourceWidth, sourceHeight);\n        ctx.scale(1, -1);\n        break;\n\n      case 8:\n        // 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI);\n        ctx.translate(0, -sourceHeight);\n        break;\n    } // Some orientation combinations require additional rotation by 180°:\n\n\n    if (requiresRot180(orientation, autoOrientation)) {\n      ctx.translate(sourceWidth, sourceHeight);\n      ctx.rotate(Math.PI);\n    }\n\n    switch (orientation) {\n      case 2:\n        // Horizontal flip\n        ctx.translate(width, 0);\n        ctx.scale(-1, 1);\n        break;\n\n      case 3:\n        // 180° Rotate CCW\n        ctx.translate(width, height);\n        ctx.rotate(Math.PI);\n        break;\n\n      case 4:\n        // Vertical flip\n        ctx.translate(0, height);\n        ctx.scale(1, -1);\n        break;\n\n      case 5:\n        // Vertical flip + 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI);\n        ctx.scale(1, -1);\n        break;\n\n      case 6:\n        // 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI);\n        ctx.translate(0, -height);\n        break;\n\n      case 7:\n        // Horizontal flip + 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI);\n        ctx.translate(width, -height);\n        ctx.scale(-1, 1);\n        break;\n\n      case 8:\n        // 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI);\n        ctx.translate(-width, 0);\n        break;\n    }\n  };\n});","map":{"version":3,"sources":["/Users/annaisthebest/Desktop/hci-ClassMates/node_modules/blueimp-load-image/js/load-image-orientation.js"],"names":["factory","define","amd","module","exports","require","window","loadImage","originalTransform","transform","originalRequiresCanvas","requiresCanvas","originalRequiresMetaData","requiresMetaData","originalTransformCoordinates","transformCoordinates","originalGetTransformedOptions","getTransformedOptions","$","global","document","testImageURL","img","createElement","onload","orientation","width","height","canvas","createCanvas","ctx","getContext","drawImage","orientationCropBug","getImageData","data","toString","src","requiresCanvasOrientation","options","withMetaData","requiresOrientationChange","autoOrientation","requiresRot180","call","callback","file","exif","get","originalWidth","originalHeight","opts","exifOrientation","top","right","bottom","left","newOptions","i","Object","prototype","hasOwnProperty","maxWidth","maxHeight","minWidth","minHeight","sourceWidth","sourceHeight","tmpTop","tmpRight","translate","scale","rotate","Math","PI"],"mappings":"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","sourcesContent":["/*\n * JavaScript Load Image Orientation\n * https://github.com/blueimp/JavaScript-Load-Image\n *\n * Copyright 2013, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n */\n\n/*\nExif orientation values to correctly display the letter F:\n\n    1             2\n  ██████        ██████\n  ██                ██\n  ████            ████\n  ██                ██\n  ██                ██\n\n    3             4\n      ██        ██\n      ██        ██\n    ████        ████\n      ██        ██\n  ██████        ██████\n\n    5             6\n██████████    ██\n██  ██        ██  ██\n██            ██████████\n\n    7             8\n        ██    ██████████\n    ██  ██        ██  ██\n██████████            ██\n\n*/\n\n/* global define, module, require */\n\n;(function (factory) {\n  'use strict'\n  if (typeof define === 'function' && define.amd) {\n    // Register as an anonymous AMD module:\n    define(['./load-image', './load-image-scale', './load-image-meta'], factory)\n  } else if (typeof module === 'object' && module.exports) {\n    factory(\n      require('./load-image'),\n      require('./load-image-scale'),\n      require('./load-image-meta')\n    )\n  } else {\n    // Browser globals:\n    factory(window.loadImage)\n  }\n})(function (loadImage) {\n  'use strict'\n\n  var originalTransform = loadImage.transform\n  var originalRequiresCanvas = loadImage.requiresCanvas\n  var originalRequiresMetaData = loadImage.requiresMetaData\n  var originalTransformCoordinates = loadImage.transformCoordinates\n  var originalGetTransformedOptions = loadImage.getTransformedOptions\n\n  ;(function ($) {\n    // Guard for non-browser environments (e.g. server-side rendering):\n    if (!$.global.document) return\n    // black+white 3x2 JPEG, with the following meta information set:\n    // - EXIF Orientation: 6 (Rotated 90° CCW)\n    // Image data layout (B=black, F=white):\n    // BFF\n    // BBB\n    var testImageURL =\n      'data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA' +\n      'AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA' +\n      'QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE' +\n      'BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/x' +\n      'ABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAA' +\n      'AAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQ' +\n      'voP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXw' +\n      'H/9k='\n    var img = document.createElement('img')\n    img.onload = function () {\n      // Check if the browser supports automatic image orientation:\n      $.orientation = img.width === 2 && img.height === 3\n      if ($.orientation) {\n        var canvas = $.createCanvas(1, 1, true)\n        var ctx = canvas.getContext('2d')\n        ctx.drawImage(img, 1, 1, 1, 1, 0, 0, 1, 1)\n        // Check if the source image coordinates (sX, sY, sWidth, sHeight) are\n        // correctly applied to the auto-orientated image, which should result\n        // in a white opaque pixel (e.g. in Safari).\n        // Browsers that show a transparent pixel (e.g. Chromium) fail to crop\n        // auto-oriented images correctly and require a workaround, e.g.\n        // drawing the complete source image to an intermediate canvas first.\n        // See https://bugs.chromium.org/p/chromium/issues/detail?id=1074354\n        $.orientationCropBug =\n          ctx.getImageData(0, 0, 1, 1).data.toString() !== '255,255,255,255'\n      }\n    }\n    img.src = testImageURL\n  })(loadImage)\n\n  /**\n   * Determines if the orientation requires a canvas element.\n   *\n   * @param {object} [options] Options object\n   * @param {boolean} [withMetaData] Is metadata required for orientation\n   * @returns {boolean} Returns true if orientation requires canvas/meta\n   */\n  function requiresCanvasOrientation(options, withMetaData) {\n    var orientation = options && options.orientation\n    return (\n      // Exif orientation for browsers without automatic image orientation:\n      (orientation === true && !loadImage.orientation) ||\n      // Orientation reset for browsers with automatic image orientation:\n      (orientation === 1 && loadImage.orientation) ||\n      // Orientation to defined value, requires meta for orientation reset only:\n      ((!withMetaData || loadImage.orientation) &&\n        orientation > 1 &&\n        orientation < 9)\n    )\n  }\n\n  /**\n   * Determines if the image requires an orientation change.\n   *\n   * @param {number} [orientation] Defined orientation value\n   * @param {number} [autoOrientation] Auto-orientation based on Exif data\n   * @returns {boolean} Returns true if an orientation change is required\n   */\n  function requiresOrientationChange(orientation, autoOrientation) {\n    return (\n      orientation !== autoOrientation &&\n      ((orientation === 1 && autoOrientation > 1 && autoOrientation < 9) ||\n        (orientation > 1 && orientation < 9))\n    )\n  }\n\n  /**\n   * Determines orientation combinations that require a rotation by 180°.\n   *\n   * The following is a list of combinations that return true:\n   *\n   * 2 (flip) => 5 (rot90,flip), 7 (rot90,flip), 6 (rot90), 8 (rot90)\n   * 4 (flip) => 5 (rot90,flip), 7 (rot90,flip), 6 (rot90), 8 (rot90)\n   *\n   * 5 (rot90,flip) => 2 (flip), 4 (flip), 6 (rot90), 8 (rot90)\n   * 7 (rot90,flip) => 2 (flip), 4 (flip), 6 (rot90), 8 (rot90)\n   *\n   * 6 (rot90) => 2 (flip), 4 (flip), 5 (rot90,flip), 7 (rot90,flip)\n   * 8 (rot90) => 2 (flip), 4 (flip), 5 (rot90,flip), 7 (rot90,flip)\n   *\n   * @param {number} [orientation] Defined orientation value\n   * @param {number} [autoOrientation] Auto-orientation based on Exif data\n   * @returns {boolean} Returns true if rotation by 180° is required\n   */\n  function requiresRot180(orientation, autoOrientation) {\n    if (autoOrientation > 1 && autoOrientation < 9) {\n      switch (orientation) {\n        case 2:\n        case 4:\n          return autoOrientation > 4\n        case 5:\n        case 7:\n          return autoOrientation % 2 === 0\n        case 6:\n        case 8:\n          return (\n            autoOrientation === 2 ||\n            autoOrientation === 4 ||\n            autoOrientation === 5 ||\n            autoOrientation === 7\n          )\n      }\n    }\n    return false\n  }\n\n  // Determines if the target image should be a canvas element:\n  loadImage.requiresCanvas = function (options) {\n    return (\n      requiresCanvasOrientation(options) ||\n      originalRequiresCanvas.call(loadImage, options)\n    )\n  }\n\n  // Determines if metadata should be loaded automatically:\n  loadImage.requiresMetaData = function (options) {\n    return (\n      requiresCanvasOrientation(options, true) ||\n      originalRequiresMetaData.call(loadImage, options)\n    )\n  }\n\n  loadImage.transform = function (img, options, callback, file, data) {\n    originalTransform.call(\n      loadImage,\n      img,\n      options,\n      function (img, data) {\n        if (data) {\n          var autoOrientation =\n            loadImage.orientation && data.exif && data.exif.get('Orientation')\n          if (autoOrientation > 4 && autoOrientation < 9) {\n            // Automatic image orientation switched image dimensions\n            var originalWidth = data.originalWidth\n            var originalHeight = data.originalHeight\n            data.originalWidth = originalHeight\n            data.originalHeight = originalWidth\n          }\n        }\n        callback(img, data)\n      },\n      file,\n      data\n    )\n  }\n\n  // Transforms coordinate and dimension options\n  // based on the given orientation option:\n  loadImage.getTransformedOptions = function (img, opts, data) {\n    var options = originalGetTransformedOptions.call(loadImage, img, opts)\n    var exifOrientation = data.exif && data.exif.get('Orientation')\n    var orientation = options.orientation\n    var autoOrientation = loadImage.orientation && exifOrientation\n    if (orientation === true) orientation = exifOrientation\n    if (!requiresOrientationChange(orientation, autoOrientation)) {\n      return options\n    }\n    var top = options.top\n    var right = options.right\n    var bottom = options.bottom\n    var left = options.left\n    var newOptions = {}\n    for (var i in options) {\n      if (Object.prototype.hasOwnProperty.call(options, i)) {\n        newOptions[i] = options[i]\n      }\n    }\n    newOptions.orientation = orientation\n    if (\n      (orientation > 4 && !(autoOrientation > 4)) ||\n      (orientation < 5 && autoOrientation > 4)\n    ) {\n      // Image dimensions and target dimensions are switched\n      newOptions.maxWidth = options.maxHeight\n      newOptions.maxHeight = options.maxWidth\n      newOptions.minWidth = options.minHeight\n      newOptions.minHeight = options.minWidth\n      newOptions.sourceWidth = options.sourceHeight\n      newOptions.sourceHeight = options.sourceWidth\n    }\n    if (autoOrientation > 1) {\n      // Browsers which correctly apply source image coordinates to\n      // auto-oriented images\n      switch (autoOrientation) {\n        case 2:\n          // Horizontal flip\n          right = options.left\n          left = options.right\n          break\n        case 3:\n          // 180° Rotate CCW\n          top = options.bottom\n          right = options.left\n          bottom = options.top\n          left = options.right\n          break\n        case 4:\n          // Vertical flip\n          top = options.bottom\n          bottom = options.top\n          break\n        case 5:\n          // Horizontal flip + 90° Rotate CCW\n          top = options.left\n          right = options.bottom\n          bottom = options.right\n          left = options.top\n          break\n        case 6:\n          // 90° Rotate CCW\n          top = options.left\n          right = options.top\n          bottom = options.right\n          left = options.bottom\n          break\n        case 7:\n          // Vertical flip + 90° Rotate CCW\n          top = options.right\n          right = options.top\n          bottom = options.left\n          left = options.bottom\n          break\n        case 8:\n          // 90° Rotate CW\n          top = options.right\n          right = options.bottom\n          bottom = options.left\n          left = options.top\n          break\n      }\n      // Some orientation combinations require additional rotation by 180°:\n      if (requiresRot180(orientation, autoOrientation)) {\n        var tmpTop = top\n        var tmpRight = right\n        top = bottom\n        right = left\n        bottom = tmpTop\n        left = tmpRight\n      }\n    }\n    newOptions.top = top\n    newOptions.right = right\n    newOptions.bottom = bottom\n    newOptions.left = left\n    // Account for defined browser orientation:\n    switch (orientation) {\n      case 2:\n        // Horizontal flip\n        newOptions.right = left\n        newOptions.left = right\n        break\n      case 3:\n        // 180° Rotate CCW\n        newOptions.top = bottom\n        newOptions.right = left\n        newOptions.bottom = top\n        newOptions.left = right\n        break\n      case 4:\n        // Vertical flip\n        newOptions.top = bottom\n        newOptions.bottom = top\n        break\n      case 5:\n        // Vertical flip + 90° Rotate CW\n        newOptions.top = left\n        newOptions.right = bottom\n        newOptions.bottom = right\n        newOptions.left = top\n        break\n      case 6:\n        // 90° Rotate CW\n        newOptions.top = right\n        newOptions.right = bottom\n        newOptions.bottom = left\n        newOptions.left = top\n        break\n      case 7:\n        // Horizontal flip + 90° Rotate CW\n        newOptions.top = right\n        newOptions.right = top\n        newOptions.bottom = left\n        newOptions.left = bottom\n        break\n      case 8:\n        // 90° Rotate CCW\n        newOptions.top = left\n        newOptions.right = top\n        newOptions.bottom = right\n        newOptions.left = bottom\n        break\n    }\n    return newOptions\n  }\n\n  // Transform image orientation based on the given EXIF orientation option:\n  loadImage.transformCoordinates = function (canvas, options, data) {\n    originalTransformCoordinates.call(loadImage, canvas, options, data)\n    var orientation = options.orientation\n    var autoOrientation =\n      loadImage.orientation && data.exif && data.exif.get('Orientation')\n    if (!requiresOrientationChange(orientation, autoOrientation)) {\n      return\n    }\n    var ctx = canvas.getContext('2d')\n    var width = canvas.width\n    var height = canvas.height\n    var sourceWidth = width\n    var sourceHeight = height\n    if (\n      (orientation > 4 && !(autoOrientation > 4)) ||\n      (orientation < 5 && autoOrientation > 4)\n    ) {\n      // Image dimensions and target dimensions are switched\n      canvas.width = height\n      canvas.height = width\n    }\n    if (orientation > 4) {\n      // Destination and source dimensions are switched\n      sourceWidth = height\n      sourceHeight = width\n    }\n    // Reset automatic browser orientation:\n    switch (autoOrientation) {\n      case 2:\n        // Horizontal flip\n        ctx.translate(sourceWidth, 0)\n        ctx.scale(-1, 1)\n        break\n      case 3:\n        // 180° Rotate CCW\n        ctx.translate(sourceWidth, sourceHeight)\n        ctx.rotate(Math.PI)\n        break\n      case 4:\n        // Vertical flip\n        ctx.translate(0, sourceHeight)\n        ctx.scale(1, -1)\n        break\n      case 5:\n        // Horizontal flip + 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI)\n        ctx.scale(-1, 1)\n        break\n      case 6:\n        // 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI)\n        ctx.translate(-sourceWidth, 0)\n        break\n      case 7:\n        // Vertical flip + 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI)\n        ctx.translate(-sourceWidth, sourceHeight)\n        ctx.scale(1, -1)\n        break\n      case 8:\n        // 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI)\n        ctx.translate(0, -sourceHeight)\n        break\n    }\n    // Some orientation combinations require additional rotation by 180°:\n    if (requiresRot180(orientation, autoOrientation)) {\n      ctx.translate(sourceWidth, sourceHeight)\n      ctx.rotate(Math.PI)\n    }\n    switch (orientation) {\n      case 2:\n        // Horizontal flip\n        ctx.translate(width, 0)\n        ctx.scale(-1, 1)\n        break\n      case 3:\n        // 180° Rotate CCW\n        ctx.translate(width, height)\n        ctx.rotate(Math.PI)\n        break\n      case 4:\n        // Vertical flip\n        ctx.translate(0, height)\n        ctx.scale(1, -1)\n        break\n      case 5:\n        // Vertical flip + 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI)\n        ctx.scale(1, -1)\n        break\n      case 6:\n        // 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI)\n        ctx.translate(0, -height)\n        break\n      case 7:\n        // Horizontal flip + 90° Rotate CW\n        ctx.rotate(0.5 * Math.PI)\n        ctx.translate(width, -height)\n        ctx.scale(-1, 1)\n        break\n      case 8:\n        // 90° Rotate CCW\n        ctx.rotate(-0.5 * Math.PI)\n        ctx.translate(-width, 0)\n        break\n    }\n  }\n})\n"]},"metadata":{},"sourceType":"script"}